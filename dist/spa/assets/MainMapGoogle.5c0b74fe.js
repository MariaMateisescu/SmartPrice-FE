import{Q as z}from"./QSlider.849e4be2.js";import{Q as P,a as B}from"./QDialog.e7626b2d.js";import{_ as L,o as r,c as m,a,ac as t,bL as S,N as l,bd as i,a4 as g,T as p,aR as h,a5 as _,bI as N,aS as f,d as O,bf as b,bN as T,ab as U,c1 as R,aO as A,aM as W}from"./index.99128b48.js";import{Q,a as w}from"./QCard.f619c392.js";import{Q as k}from"./QSeparator.0cea0c41.js";import{Q as x,a as M}from"./QItemSection.3292a689.js";import{C as K}from"./ClosePopup.45393387.js";import{u as j}from"./geolocation-info.45236c28.js";import{Q as q}from"./QList.4fd948dc.js";var E="/assets/bluedot.122d0e85.png";const F={name:"ProductsInCategoryInLocation",emits:["goBackToCategories"],props:["categoryInfo","locationInfo"],data(){return{products:[]}},async mounted(){console.log("text",this.locationInfo);const o=await this.$api.get(`/categories/${this.locationInfo.location._id}/${this.categoryInfo._id}`);this.products=o.data.data.productsInCategoryInLocation,console.log(this.products)}};function H(o,s,u,I,e,c){return r(),m(p,null,[a("div",null,[t(k),t(S,{name:"arrow_back_ios",onClick:s[0]||(s[0]=d=>o.$emit("goBackToCategories"))}),a("strong",null,l(u.categoryInfo.name),1),t(k)]),t(Q,null,{default:i(()=>[e.products.length?(r(),g(q,{key:0,dense:"",bordered:"",padding:"",class:"rounded-borders"},{default:i(()=>[(r(!0),m(p,null,h(e.products,d=>(r(),m("div",{key:d._id},[d?(r(),g(x,{key:0,class:"flex justify-between"},{default:i(()=>[a("div",null,l(d.brand)+" "+l(d.name)+" "+l(d.weight),1),a("div",null,l(d.price)+" lei",1)]),_:2},1024)):_("",!0)]))),128))]),_:1})):_("",!0)]),_:1})],64)}var J=L(F,[["render",H],["__scopeId","data-v-7d46b53e"]]);const X={components:{ProductsInCategoryInLocation:J},data(){return{openedMarkerID:null,zoom:13,currentLocationIcon:E,circleOptions:{strokeColor:"#4c8bf5",strokeOpacity:.7,strokeWeight:2,fillColor:"#4c8bf5",fillOpacity:.1},locationInfo:null,showLocationDetails:!1,categories:[],categoryInfo:null}},setup(){const o=N(),s=j();return{userStore:o,geolocationInfo:s}},props:["marketsList","myCoordinates"],async mounted(){await this.fetchCategories()},methods:{openMarker(o){this.openedMarkerID=o},addKm(o){return o+"km"},sliderChanged(o){this.$emit("onSliderChanged",o)},showLocationDetailsDialog(o){this.locationInfo=o,this.showLocationDetails=!0,console.log(this.locationInfo)},async fetchCategories(){const o=await this.$api.get("/categories");this.categories=o.data.data.categories},viewProductsInCategory(o){this.categoryInfo=o}},computed:{circleRadius(){return this.geolocationInfo.$state.radius*1e3},isAdmin(){return this.userStore.authUser&&this.userStore.authUser.role==="admin"}}},Y=o=>(A("data-v-3217c3d0"),o=o(),W(),o),Z={style:{color:"black"}},$=["onClick"],oo={class:"slider-box"},eo=Y(()=>a("div",{class:"text-h6"},"Location details",-1)),to={class:"logo-container"},no=["src"],ao={key:0};function so(o,s,u,I,e,c){const d=f("GMapInfoWindow"),y=f("GMapMarker"),D=f("GMapCircle"),G=f("GMapMap"),V=f("ProductsInCategoryInLocation");return r(),m("div",null,[t(G,{center:u.myCoordinates,zoom:e.zoom,class:O(["map-style",[c.isAdmin?"without-footer-map-height":"with-footer-map-height"]])},{default:i(()=>[(r(!0),m(p,null,h(u.marketsList,(n,C)=>(r(),g(y,{key:C,position:n.location.coordinates,icon:{url:n.market.logo,scaledSize:{width:30,height:30},labelOrigin:{x:16,y:-10}},clickable:!0,onClick:v=>c.openMarker(n.location._id)},{default:i(()=>[t(d,{closeclick:!0,onCloseclick:s[0]||(s[0]=v=>c.openMarker(null)),opened:e.openedMarkerID===n.location._id},{default:i(()=>[a("div",Z,l(n.location.address),1),a("button",{onClick:v=>c.showLocationDetailsDialog(n),class:"location-details-button"}," Details ",8,$)]),_:2},1032,["opened"])]),_:2},1032,["position","icon","onClick"]))),128)),t(y,{position:{lat:u.myCoordinates.lat,lng:u.myCoordinates.lng},icon:{url:e.currentLocationIcon,scaledSize:{width:18,height:18}}},null,8,["position","icon"]),t(D,{radius:c.circleRadius,center:{lat:u.myCoordinates.lat,lng:u.myCoordinates.lng},options:e.circleOptions},null,8,["radius","center","options"])]),_:1},8,["center","zoom","class"]),a("div",oo,[t(z,{class:"slider",modelValue:I.geolocationInfo.radius,"onUpdate:modelValue":s[1]||(s[1]=n=>I.geolocationInfo.radius=n),markers:"","marker-labels":c.addKm,min:1,max:7,onChange:c.sliderChanged},null,8,["modelValue","marker-labels","onChange"])]),t(B,{maximized:"",modelValue:e.showLocationDetails,"onUpdate:modelValue":s[3]||(s[3]=n=>e.showLocationDetails=n)},{default:i(()=>[t(Q,null,{default:i(()=>[t(w,{class:"row items-center q-pb-none"},{default:i(()=>[eo,t(P),b(t(T,{icon:"close",flat:"",round:"",dense:""},null,512),[[K]])]),_:1}),t(w,{style:{"font-size":"16px"}},{default:i(()=>[a("div",to,[a("img",{class:"logo",src:e.locationInfo.market.logo,alt:"logo"},null,8,no),a("div",null,[a("div",null,l(e.locationInfo.location.name),1),a("div",null,"Adresa: "+l(e.locationInfo.location.address),1),a("div",null,"Program: "+l(e.locationInfo.location.openingHours),1)])]),t(k),e.categoryInfo?_("",!0):(r(),m("div",ao,[(r(!0),m(p,null,h(e.categories,n=>b((r(),g(x,{clickable:"",key:n._id},{default:i(()=>[t(M,{thumbnail:"",style:{color:"#00838f"}},{default:i(()=>[t(S,{name:n.icon},null,8,["name"])]),_:2},1024),t(M,{onClick:C=>c.viewProductsInCategory(n)},{default:i(()=>[U(l(n.name),1)]),_:2},1032,["onClick"])]),_:2},1024)),[[R]])),128))])),e.categoryInfo?(r(),g(V,{key:1,categoryInfo:e.categoryInfo,locationInfo:e.locationInfo,onGoBackToCategories:s[2]||(s[2]=n=>e.categoryInfo=null)},null,8,["categoryInfo","locationInfo"])):_("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var _o=L(X,[["render",so],["__scopeId","data-v-3217c3d0"]]);export{_o as M};
