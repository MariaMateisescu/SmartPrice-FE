import{M as n}from"./MainMapGoogle.2187c5cd.js";import{_ as r,bJ as c,aS as m,o as l,c as d,ac as h}from"./index.34950785.js";import"./QSlider.6c2a797e.js";import"./QCard.d2345bc1.js";import"./use-timeout.46593e9e.js";import"./TouchPan.ae1ee8da.js";import"./selection.4b1bcd79.js";import"./format.2a3572e1.js";import"./QDialog.fe157533.js";import"./ClosePopup.b7f1f5d3.js";import"./QSeparator.309c43aa.js";import"./QItemSection.244aabe5.js";import"./geolocation-info.820bca6e.js";import"./QList.32a19b7c.js";const p={name:"HomePage",components:{MainMapGoogle:n},data(){return{marketsList:[],radius:4,latlng:"",myCoordinates:{lat:0,lng:0}}},async mounted(){c().$patch({title:"Smart Price",showBackIcon:!1});try{let t=await this.getPosition();this.myCoordinates.lat=t.coords.latitude,this.myCoordinates.lng=t.coords.longitude,this.latlng=this.myCoordinates.lat+","+this.myCoordinates.lng,this.fetchLocationsWithin()}catch(t){console.log(t)}},methods:{getPosition(){return new Promise((o,t)=>{navigator.geolocation.getCurrentPosition(o,t)})},async fetchLocationsWithin(o){o&&(this.radius=o);const t=await this.$api.get(`/locations/locations-within/${this.radius}/center/${this.latlng}`);this.marketsList=t.data.marketsWithin}},computed:{locationsToBeDisplayed(){const o=[];return this.marketsList.map(t=>{t.locations.forEach(i=>{o.push({location:i,market:{logo:t.market.logo,_id:t.market._id}})})}),o}}};function g(o,t,i,u,e,a){const s=m("MainMapGoogle");return l(),d("div",null,[h(s,{marketsList:a.locationsToBeDisplayed,myCoordinates:e.myCoordinates,onOnSliderChanged:a.fetchLocationsWithin},null,8,["marketsList","myCoordinates","onOnSliderChanged"])])}var w=r(p,[["render",g]]);export{w as default};
